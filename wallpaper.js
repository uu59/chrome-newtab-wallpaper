var Wallpaper = (function(){
  var wall = document.querySelector('#wall');
  var image;
  var currentStyle;


  return {
    init: function() {
      currentStyle = localStorage.getItem('style') || "expand";
      Wallpaper.adjustWindow();
      window.addEventListener("resize", Wallpaper.adjustWindow, false);
      var img = localStorage.getItem("image") || "data:image/png;base64,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wwXaxFOEQHZ/E8vLC88880yYMGFCm/+slStXhgsuuCDE6NsiILCADq5fv35hw4YNoV+/fof9Z1RXV4chQ4aE6upqBwq0mWuwgKxXXV0drrjiisP+yVOMMcyePVtcAe3GNVhATqioqAg9e/YMo0aNavW/e88994SHHnrIIQLtxlOEQM4oKCgIa9asCSNGjDjkf6e0tDSMGTMmNDY2OkBAYAF8kBNPPDGUlZWFj33sYx/5z9bU1IShQ4eGyspKBwe0K9dgATmloqIizJ0795D+2euuu05cAQIL4FA88sgj4eGHHz7oP/PLX/4yLFmyxGEBKeEpQiAn9ezZM7zyyith4MCB//X/vf7662HYsGHhvffec1BASvgJFpCTamtrQ3FxcWhoaPiP/72hoSFceuml4goQWACH4+WXXw4LFy78j/9twYIFoayszOEAKeUpQiC3v8nl5YWnnnoqTJ48OSxfvjx85jOf8VY4gMACaKuioqKwYsWKMGnSpPDmm286EEBgAbSHgoICLyYKCCwAgGzlIncAAIEFACCwAAAEFgAAAgsAQGABAAgsAAAEFgCAwAIAEFgAAAgsAACBBQAgsAAABBYAAAILAEBgAQAILAAABBYAgMACABBYAAAILAAAgQUAILAAABBYAAACCwBAYAEACCwAAAQWAIDAAgAQWAAACCwAAIEFACCwAAAQWAAAAgsAQGABACCwAAAEFgCAwAIAEFgAAAgsAACBBQAgsAAAEFgAAAILAEBgAQAgsAAABBYAgMACAEBgAQAILAAAgQUAILAAABBYAAACCwBAYAEAILAAAAQWAIDAAgBAYAEACCwAAIEFACCwAABoR51j4w+dAgBAO/ITLAAAgQUAILAAAAQWAAACCwBAYAEACCwAAAQWAIDAAgAQWAAACCwAAIEFACCwAAAEFgAAAgsAQGABAAgsAAAEFgCAwAIAEFgAAAgsAACBBQAgsAAAEFgAAAILAEBgAQAILAAABBYAgMACABBYAAAILAAAgQUAILAAABBYAAACCwAga/0Pr6FsyLk6vtgAAAAASUVORK5CYII=";
      Wallpaper.setImage(img);

      var file = document.querySelector('#file');
      file.onchange = function(e){
        var f = this.files[0];
        var reader = new FileReader();
        reader.onload = function(ev){
          var data = ev.target.result;
          localStorage.setItem("image", data);
          Wallpaper.setImage(data);
          file.value = "";
        };
        reader.readAsDataURL(f);
      };

      var dummyFile = document.querySelector('#dummy');
      dummyFile.onclick = function(){
        file.click();
      };

      var select = document.querySelector('#style');
      select.onclick = function(e){
        Wallpaper.updateStyle(e.target.parentNode.title);
      };
    },

    setImage: function(uri){
      image = uri;
      localStorage.setItem('image', image);
      this.updateStyle();
    },

    adjustWindow: function() {
      wall.style.height = window.innerHeight + "px";
      wall.style.width = window.innerWidth + "px";
    },

    updateStyle: function(style) {
      currentStyle = style || currentStyle;
      var styles = document.querySelectorAll('#style span');
      localStorage.setItem('style', currentStyle);
      Array.prototype.forEach.call(styles, function(span){
        span.classList.remove("selected");
        if(span.title == currentStyle) {
          span.classList.add("selected");
        }
      });

      switch(currentStyle) {
        case "expand":
          wall.style.backgroundImage = "";
          wall.innerHTML = '<img width="100%" height="100%" src="' + image + '" />';
          break;

        case "center":
          wall.style.backgroundImage = "";
          wall.innerHTML = '<img src="' + image + '" />';
          break;

        case "tile":
          wall.innerHTML = "";
          wall.style.backgroundImage = "url(" + image + ")";
          break;
      }
    }
  };
})();


Wallpaper.init();
